<ng-template #notLoaded>
    <div class="text-center">
        <div class="spinner-border center-loading" role="status">
            <span class="sr-only">Loading...</span>
        </div>
    </div>
</ng-template>

<div *ngIf="loaded; else notLoaded">
    <div class="d-flex mb-3">
        <div>
            <h2>{{note.title}}</h2>
        </div>
        <div class="ml-auto">
            <div class="btn-group">
                <button [routerLink]="['/notes', note.id, 'edit']" class="btn btn-info mr-2">Edit</button>
                <button (click)="openDeleteModal()" class="btn btn-danger">Delete</button>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12 mb-3">
            <div class="card card-body ">
                <app-markdown-view [markdown]="note.markdownText"></app-markdown-view>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12 mb-3">
            <div class="card">
                <div class="card-body">
                    <p><app-time-ago prefix="Last updated " [date]="note.dateUpdated"></app-time-ago></p>
                    <p>Version {{note.version}}</p>

                    <h4 *ngIf="note.props.tasks.length > 0">Tasks</h4>
                    <ul>
                        <li *ngFor="let task of note.props.tasks">{{task.description}}</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12 mb-3">
            <div class="card">
                <div class="card-body">
                    <h5 *ngIf="note.tags.length > 0">Tags</h5>
                    <span *ngFor="let tag of note.tags" class="badge badge-primary p-2 mr-1">{{tag.name}}</span>

                    <h5 *ngIf="note.collections.length > 0">Collections</h5>
                    <span *ngFor="let collection of note.collections" class="badge badge-primary p-2 mr-1">{{collection.name}}</span>
                </div>
            </div>
        </div>
    </div>

</div>

<div class="row">
    <div class="col-md-12 mb-3">
        <app-comment-list [entryId]="id"></app-comment-list>
    </div>
</div>
